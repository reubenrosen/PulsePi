<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PulsePi Project Progress</title>
  <style>
    :root {
      --bg: #0f172a;
      --card: #111827;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #38bdf8;
      --success: #22c55e;
      --fail: #ef4444;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: linear-gradient(180deg, #020617, var(--bg));
      color: var(--text);
      line-height: 1.6;
    }

    header {
      padding: 3rem 1.5rem;
      text-align: center;
    }

    .logo {
      width: 65px;
      height: auto;
      margin-bottom: 1rem;
      opacity: 0.95;
      filter: drop-shadow(0 6px 16px rgba(0,0,0,0.4));
    }

    header h1 {
      font-size: clamp(2rem, 4vw, 3rem);
      margin-bottom: 0.5rem;
    }

    header p {
      color: var(--muted);
      max-width: 700px;
      margin: 0 auto;
    }
    .repo-link {
    color: var(--accent);
    text-decoration: none;
    font-weight: 600;
   }
  
    .repo-link:hover {
      text-decoration: underline;
    }

    main {
      max-width: 1000px;
      margin: 0 auto;
      padding: 1.5rem;
      display: grid;
      gap: 1.5rem;
    }

    .phase {
      background: var(--card);
      border-radius: 1rem;
      padding: 1.5rem;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      display: grid;
      gap: 1rem;
    }

    .phase-header {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      gap: 0.75rem;
    }

    .phase-header h2 {
      margin: 0;
      font-size: 1.4rem;
    }

    .status {
      padding: 0.25rem 0.75rem;
      border-radius: 999px;
      font-size: 0.85rem;
      font-weight: 600;
    }

    .done { background: rgba(34,197,94,0.15); color: var(--success); }
    .failed { background: rgba(239,68,68,0.15); color: var(--fail); }
    .in-progress { background: rgba(56,189,248,0.15); color: var(--accent); }

    ul {
      padding-left: 1.2rem;
      margin: 0;
    }

    .phase-content {
      display: grid;
      grid-template-columns: 1fr 350px;
      gap: 1.2rem;
      align-items: start;
    }

    .media-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 0.75rem;
    }

    .media-grid img,
    .media-grid video,
    .media-grid iframe {
      width: 100%;
      border-radius: 0.75rem;
      border: 1px solid rgba(255,255,255,0.08);
      background: #000;
      object-fit: cover;
      aspect-ratio: 1 / 1;
      cursor: pointer;
      transition: transform 0.25s ease;
    }

    .media-grid img:hover,
    .media-grid video:hover,
    .media-grid iframe:hover {
      transform: scale(1.05);
    }

    .media-grid video { object-fit: contain; }
    .media-grid iframe { aspect-ratio: 16 / 9; }

    @media (max-width: 700px) {
      .phase-content { grid-template-columns: 1fr; }
    }

    footer {
      text-align: center;
      padding: 2rem 1rem;
      color: var(--muted);
      font-size: 0.9rem;
    }

    /* LIGHTBOX */
    .lightbox {
      position: fixed;
      inset: 0;
      backdrop-filter: blur(10px);
      background: rgba(0,0,0,0.85);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      z-index: 9999;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .lightbox.active {
      opacity: 1;
      pointer-events: auto;
    }

    .lightbox-content {
      position: relative;
      max-width: 95vw;
      max-height: 90vh;
      animation: zoomIn 0.25s ease;
    }

    @keyframes zoomIn {
      from { transform: scale(0.85); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    .lightbox img,
    .lightbox video,
    .lightbox iframe {
      max-width: 100%;
      max-height: 90vh;
      border-radius: 1rem;
      box-shadow: 0 20px 60px rgba(0,0,0,0.6);
    }

    .lightbox-close,
    .lightbox-prev,
    .lightbox-next {
      position: absolute;
      color: white;
      font-size: 2rem;
      cursor: pointer;
      user-select: none;
    }

    .lightbox-close { top: 1.5rem; right: 2rem; }
    .lightbox-prev { left: 2rem; top: 50%; transform: translateY(-50%); }
    .lightbox-next { right: 2rem; top: 50%; transform: translateY(-50%); }
  </style>
</head>

<body>

<header>
  <img src="images/logo.png" alt="PulsePi Logo" class="logo" />
  <h1>PulsePi Project Log</h1>
  <p>
    Documenting progress, validation experiments, and engineering decisions in public.
  </p>
  <p>
    <a href="https://github.com/reubenrosen/PulsePi/tree/main" target="_blank" class="repo-link">
      GitHub Repository
    </a>
  </p>
</header>

<main>

<!-- Phase 1 -->
<section class="phase">
  <div class="phase-header">
    <h2>Phase 1 — Initial Setup</h2>
    <span class="status done">Completed</span>
  </div>
  <div class="phase-content">
    <ul>
      <li>Completed Raspberry Pi 5 setup.</li>
      <li>Connected monitor and peripherals for development and visualization.</li>
      <li>Installed and configured Raspberry Pi Desktop OS.</li>
    </ul>
    <div class="media-grid">
      <img src="images/phase1.jpeg" alt="Phase 1 hardware setup" />
    </div>
  </div>
</section>

<!-- Phase 2 -->
<section class="phase">
  <div class="phase-header">
    <h2>Phase 2 — First Prototype</h2>
    <span class="status done">Completed</span>
  </div>
  <div class="phase-content">
    <ul>
      <li>Integrated MAX30102 optical sensor module.</li>
      <li>Initial soldered configuration failed; stabilized temporarily using jumper wires.</li>
      <li>Developed script to plot raw signal variation during finger contact.</li>
    </ul>
    <div class="media-grid">
      <img src="images/phase2.jpeg" alt="Phase 2 prototype" />
      <img src="images/phase2plot.jpeg" alt="Phase 2 prototype plot" />
    </div>
  </div>
</section>

<!-- Phase 3 -->
<section class="phase">
  <div class="phase-header">
    <h2>Phase 3 — RPi High Quality Camera Installation</h2>
    <span class="status done">Completed</span>
  </div>
  <div class="phase-content">
    <ul>
      <li>Mounted 16mm lens camera on tripod for reflected green-light capture.</li>
      <li>Evaluating 6mm lens for improved near-field focus.</li>
      <li>Added logging and error handling.</li>
    </ul>
    <div class="media-grid">
      <img src="images/phase3.jpeg" alt="Phase 3 iteration" />
    </div>
  </div>
</section>

<!-- Phase 4 -->
<section class="phase">
  <div class="phase-header">
    <h2>Phase 4 — Validation</h2>
    <span class="status done">Complete</span>
  </div>
  <div class="phase-content">
    <ul>
      <li>Simulated perfusion changes using ice-induced vasoconstriction and arm elevation.</li>
      <li>Used opposite hand as internal control.</li>
      <li>MAX30102 confirmed measurable signal dip.</li>
      <li>Camera computed mean green-channel intensity per frame to track perfusion change.</li>
      <li>Observed green intensity reduction consistent with hemoglobin absorption.</li>
    </ul>
    <div class="media-grid">
      <img src="images/phase4.png" alt="Phase 4 testing" />
      <video controls>
        <source src="videos/screencapture.mp4" type="video/mp4">
      </video>
    </div>
  </div>
</section>

<!-- Phase 5 -->
<section class="phase">
  <div class="phase-header">
    <h2>Phase 5 — Final Build</h2>
    <span class="status in-progress">Planned and In Progress</span>
  </div>
  <div class="phase-content">
    <ul>
      <li>Preparing final dark-environment capture setup to reduce ambient interference.</li>
      <li>Designing PCB layout in KiCad to transition from breadboard prototype.</li>
    </ul>
    <div class="media-grid">
      <img src="images/phase5.jpeg" alt="Phase 5 final hardware" />
    </div>
  </div>
</section>

</main>

<footer>
  <p>Repository will include schematics, firmware, and validation datasets.</p>
</footer>

<!-- LIGHTBOX -->
<div class="lightbox" id="lightbox">
  <span class="lightbox-close" id="close">&times;</span>
  <span class="lightbox-prev" id="prev">&#10094;</span>
  <span class="lightbox-next" id="next">&#10095;</span>
  <div class="lightbox-content" id="content"></div>
</div>

<script>
  const lightbox = document.getElementById("lightbox");
  const content = document.getElementById("content");
  const closeBtn = document.getElementById("close");
  const prevBtn = document.getElementById("prev");
  const nextBtn = document.getElementById("next");

  let currentIndex = 0;
  let currentMedia = [];

  function openLightbox(mediaArray, index) {
    currentMedia = mediaArray;
    currentIndex = index;
    showMedia();
    lightbox.classList.add("active");
  }

  function showMedia() {
    content.innerHTML = "";
    let clone = currentMedia[currentIndex].cloneNode(true);

    if (clone.tagName === "VIDEO") {
      clone.controls = true;
      clone.autoplay = true;
    }

    content.appendChild(clone);
  }

  function closeLightbox() {
    lightbox.classList.remove("active");
    content.innerHTML = "";
  }

  function nextMedia() {
    currentIndex = (currentIndex + 1) % currentMedia.length;
    showMedia();
  }

  function prevMedia() {
    currentIndex = (currentIndex - 1 + currentMedia.length) % currentMedia.length;
    showMedia();
  }

  document.querySelectorAll(".phase").forEach(phase => {
    const media = Array.from(phase.querySelectorAll(".media-grid img, .media-grid video, .media-grid iframe"));
    media.forEach((item, index) => {
      item.addEventListener("click", () => openLightbox(media, index));
    });
  });

  closeBtn.onclick = closeLightbox;
  nextBtn.onclick = nextMedia;
  prevBtn.onclick = prevMedia;

  document.addEventListener("keydown", e => {
    if (!lightbox.classList.contains("active")) return;
    if (e.key === "Escape") closeLightbox();
    if (e.key === "ArrowRight") nextMedia();
    if (e.key === "ArrowLeft") prevMedia();
  });

  let touchStartX = 0;

  lightbox.addEventListener("touchstart", e => {
    touchStartX = e.changedTouches[0].screenX;
  });

  lightbox.addEventListener("touchend", e => {
    let diff = e.changedTouches[0].screenX - touchStartX;
    if (diff > 50) prevMedia();
    if (diff < -50) nextMedia();
  });

  lightbox.addEventListener("click", e => {
    if (e.target === lightbox) closeLightbox();
  });
</script>

</body>
</html>
